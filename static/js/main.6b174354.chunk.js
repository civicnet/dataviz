(window["webpackJsonpdisaster-atlas"]=window["webpackJsonpdisaster-atlas"]||[]).push([[0],{245:function(e,a,t){e.exports=t(262)},250:function(e,a,t){},255:function(e,a){},262:function(e,a,t){"use strict";t.r(a);var n=t(1),r=t.n(n),i=t(36),l=t.n(i),o=(t(250),t(10)),c=t(0),s=t(13),u=t(204),d=t(266),g=t(217),m=t(312),p=t(118),f=t(305),b=t(309),y=t(303),h=t(306),v=t(295),E=t(296),O=t(307),w=t(298),j=t(299),k=t(212),S=t.n(k),W=t(213),x=t.n(W),P=t(304),R=t(164),L=t(92),C=t(175),N=t(297),I=t(300),_=t(301),T=t(302),D=t(313),A=(t(196),t(310)),F=t(308),M=t(219),Y=t(216),B=t(314),z=t(218),G=t(17),U=t(15),V=t.n(U),J=t(25),X="RECEIVE_REGIONS",H="RECEIVE_SEA_LEVELS",Z="SET_PLAYBACK_YEAR",q="TOGGLE_PLAYBACK",K="SET_CURRENT_REGION",Q="CLEAR_CURRENT_REGION";function $(e){return{type:X,regions:e}}function ee(e){return{type:H,levels:e}}var ae="".concat("/disaster-atlas","/data/"),te=function(){var e=Object(J.a)(V.a.mark(function e(a){var t;return V.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(ae).concat(a),{method:"GET",headers:{Accept:"application/json"}});case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}(),ne=function(e){return function(){var a=Object(J.a)(V.a.mark(function a(t,n){var r,i,l;return V.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if("County"!==e){a.next=9;break}if(!n().counties){a.next=3;break}return a.abrupt("return",Promise.resolve());case 3:return a.next=5,te("enhancedCounties.json");case 5:i=a.sent,r={type:"County",data:i},a.next=15;break;case 9:if(!n().uats){a.next=11;break}return a.abrupt("return",Promise.resolve());case 11:return a.next=13,te("enhancedUATs.json");case 13:l=a.sent,r={type:"UAT",data:l};case 15:t($(r));case 16:case"end":return a.stop()}},a)}));return function(e,t){return a.apply(this,arguments)}}()},re=t(119),ie=t(188),le={width:window.innerWidth,height:window.innerHeight,longitude:29.4026143,latitude:44.5968449,zoom:7.6,maxZoom:20,minZoom:6,bearing:0,pitch:0},oe=function(e,a){var t=Math.round((e-(new Date).getFullYear())/4.5);return t>=a&&(t=a-1),t},ce=Object(re.b)(function(e){return{globalWarming:e.globalWarming}},function(e){return{fetchRegions:function(a){return e(ne(a))},fetchSeaLevels:function(){return e(function(){var e=Object(J.a)(V.a.mark(function e(a,t){var n,r,i;return V.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t().seaLevels){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=Object(G.a)(Array(22).fill(null)).map(function(e,a){return a?(a/10-.3).toFixed(1):"-0.3"}),r=function(e){return"number"===typeof e&&(e=e.toFixed(1)),"".concat("/disaster-atlas","/data/sea_levels/").concat(e,".json")},e.next=6,Promise.all(n.map(function(e){return fetch(r(e),{method:"GET",headers:{Accept:"application/json"}}).then(function(e){return e.json()})}));case 6:i=e.sent,a(ee(i));case 8:case"end":return e.stop()}},e)}));return function(a,t){return e.apply(this,arguments)}}())},setSelectedRegion:function(a){return e(function(e){return{type:K,selectedRegion:e}}(a))},clearSelectedRegion:function(){return e({type:Q})}}})(function(e){var a=r.a.useState(),t=Object(o.a)(a,2),i=t[0],l=t[1],c=Object(n.useRef)(null),s=Object(n.useRef)(null),u=e.fetchRegions,d=e.fetchSeaLevels;if(Object(n.useEffect)(function(){u("County"),u("UAT"),d()},[u,d]),!e.globalWarming.seaLevels.length||!e.globalWarming.counties.length||!e.globalWarming.uats.length)return null;var g=oe(e.globalWarming.playback.year,e.globalWarming.seaLevels.length),m=e.globalWarming.seaLevels.length?e.globalWarming.seaLevels[g]:{type:"Polygon"};e.setSeaLevel(10*g);var p=function(e){var a=e.properties.damages;if(!a)return 0;var t=a.find(function(e){return e.seaLevel===g});if(!t)return 0;var n=t.bldgs;return n?Object.keys(n).reduce(function(e,a){return e+n[a]},0):0},f=[new F.a({id:"geojson-layer-uats",data:e.globalWarming.uats,pickable:!1,stroked:!0,filled:!1,lineWidthScale:1,lineWidthMinPixels:1,getLineColor:function(a){var t=e.globalWarming.selectedRegion;return t&&a.properties.code===t.code?[255,255,255,255]:[0,0,0,0]},getLineWidth:1,getPolygon:function(e){return{type:"FeatureCollection",features:[e]}},updateTriggers:{getLineColor:e.globalWarming.selectedRegion}}),new F.a({id:"geojson-layer-counties",data:e.globalWarming.counties,pickable:!1,stroked:!0,filled:!1,lineWidthScale:1,lineWidthMinPixels:1,getLineColor:[0,0,0,255],getLineWidth:2,getPolygon:function(e){return{type:"FeatureCollection",features:[e]}},visible:!1}),new F.a({id:"sea-level",data:m,pickable:!1,stroked:!1,filled:!0,extruded:!0,getFillColor:function(e,a){return[0,105,148]},opacity:.5,getElevation:function(e){return e.properties.level},transitions:{getFillColor:{duration:600,easing:ie.b,enter:function(e){return[e[0],e[1],e[2],0]}}}}),new M.a({id:"scatter",data:e.globalWarming.uats,pickable:!0,autoHighlight:!0,highlightColor:[255,0,0,128],filled:!0,stroked:!0,radiusScale:4,getPolygonOffset:function(){return[0,-100]},radiusMaxPixels:40,lineWidthMaxPixels:4,lineWidthMaxixels:2,lineWidthUnits:"pixels",getRadius:function(e){return p(e)},getLineWidth:function(e){return p(e)?1:null},getFillColor:function(a){return e.globalWarming.selectedRegion&&e.globalWarming.selectedRegion.code===a.properties.code?[255,0,0,128]:[255,0,0,70]},getLineColor:[255,0,0,255],getPosition:function(e){var a=Object(z.a)(e);return a.geometry?a.geometry.coordinates:null},onClick:function(a){var t=a.object;t&&e.setSelectedRegion(t.properties)},updateTriggers:{getRadius:g,getFillColor:e.globalWarming.selectedRegion},transitions:{getRadius:{duration:300,easing:ie.a.amplitude(1.75).period(1),enter:0}}})];return r.a.createElement(A.a,{ref:s,layers:f,initialViewState:le,controller:!0,onWebGLInitialized:function(e){l(e)}},i&&r.a.createElement(Y.a,{width:"100%",height:"100%",preventStyleDiffing:!0,ref:c,mapStyle:"mapbox://styles/claudiuc/cjzfv9blf11q21cphdwsik2tr/draft",mapboxApiAccessToken:"pk.eyJ1IjoiY2xhdWRpdWMiLCJhIjoiY2lrZXV5dzNiMDA3NnRvbHlwMWc3ZHp4YiJ9.8DeWMyPr2T8jRDeShSebTQ",gl:i,onLoad:function(){var e=c.current?c.current.getMap():null;if(e){for(var a=e.getStyle().layers,t=0,n=0;n<a.length;n++)if("water"===a[n].id){t=n;break}e.addLayer(new B.a({id:"sea-level",deck:s.current.deck}),a[t+1].id),e.addLayer(new B.a({id:"geojson-layer-uats",deck:s.current.deck}),"sea-level"),e.addLayer(new B.a({id:"scatter",deck:s.current.deck}))}}}))}),se=Object(d.a)(function(e){return Object(m.a)({root:{flex:1},faIcon:{width:"unset"},card:{bottom:100,width:600,zIndex:1e3,right:100,position:"absolute"},details:{display:"flex",flexDirection:"column"},cover:{width:151},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1),paddingRight:e.spacing(3)},playIcon:{},cardContent:{flex:"1 0 auto"},stats:{width:600,position:"absolute",top:100,right:100,color:"#fff"},statsSecondary:{color:"#ABC"},statsTitle:{paddingLeft:72}})}),ue=Object(re.b)(function(e){return{globalWarming:e.globalWarming}},function(e){return{fetchRegions:function(a){return e(ne(a))},setPlaybackYear:function(a){return e(function(e){return{type:Z,year:e}}(a))},togglePlayback:function(){return e({type:q})}}})(function(e){var a=se(),t=r.a.useState(0),n=Object(o.a)(t,2),i=n[0],l=n[1],c=r.a.useState(0),u=Object(o.a)(c,2),d=u[0],g=u[1];r.a.useEffect(function(){var a=null;return e.globalWarming.playback.isPlaying?a=setInterval(function(){if(l(i+1),0!==i&&i%5===0){if(2100===e.globalWarming.playback.year)return void e.togglePlayback();e.setPlaybackYear(e.globalWarming.playback.year+1)}},1e3/60):e.globalWarming.playback.isPlaying||0===i||clearInterval(a),function(){return clearInterval(a)}});var m=oe(e.globalWarming.playback.year,e.globalWarming.seaLevels.length),p=e.globalWarming.selectedRegion?(e.globalWarming.selectedRegion.damages||[]).find(function(e){return e.seaLevel===m}):null;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ce,{setSeaLevel:function(e){g(10*e)}}),p&&r.a.createElement("div",{className:a.stats},r.a.createElement(C.a,{variant:"h5",component:"h5",className:a.statsTitle},e.globalWarming.selectedRegion&&e.globalWarming.selectedRegion.name),r.a.createElement(C.a,{variant:"subtitle1",component:"span",className:a.statsTitle},"Jude\u021bul"," ",e.globalWarming.selectedRegion&&e.globalWarming.selectedRegion.county),r.a.createElement(v.a,null,r.a.createElement(E.a,null,r.a.createElement(N.a,null,r.a.createElement(w.a,{className:Object(s.a)("fal fa-ruler-combined")})),r.a.createElement(j.a,{classes:{secondary:a.statsSecondary},primary:"".concat((1e-6*p.area.flooded).toFixed(2)," km\xb2"),secondary:"Suprafa\u021ba de teren acoperit\u0103 de ap\u0103"})),r.a.createElement(E.a,null,r.a.createElement(N.a,null,r.a.createElement(w.a,{className:Object(s.a)("fal fa-chart-pie-alt")})),r.a.createElement(j.a,{classes:{secondary:a.statsSecondary},primary:"".concat(p.area.coverage.toFixed(2),"%"),secondary:"Propor\u021bie total\u0103 acoperit\u0103 de ap\u0103"})),r.a.createElement(E.a,null,r.a.createElement(N.a,null,r.a.createElement(w.a,{className:Object(s.a)(a.faIcon,"fal fa-house-flood")})),r.a.createElement(j.a,{classes:{secondary:a.statsSecondary},primary:p.bldgs?p.bldgs.other:0,secondary:"Num\u0103rul de cl\u0103diri inundate"})),r.a.createElement(E.a,null,r.a.createElement(N.a,null,r.a.createElement(w.a,{className:Object(s.a)(a.faIcon,"fal fa-hiking")})),r.a.createElement(j.a,{classes:{secondary:a.statsSecondary},primary:e.globalWarming.selectedRegion?Math.floor(e.globalWarming.selectedRegion.pop2015*(p.area.coverage/100)):0,secondary:"Num\u0103rul de persoane evacuate"})))),r.a.createElement(I.a,{className:a.card},r.a.createElement("div",{className:a.details},r.a.createElement(_.a,{className:a.cardContent},r.a.createElement(C.a,{component:"h1",variant:"h3"},e.globalWarming.playback.year),r.a.createElement(C.a,{variant:"subtitle1",color:"textSecondary"},"Nivelul m\u0103rii estimat la ",d,"mm")),r.a.createElement("div",{className:a.controls},r.a.createElement(T.a,{container:!0,spacing:2},r.a.createElement(T.a,{item:!0},r.a.createElement(y.a,{"aria-label":"play/pause",onClick:e.togglePlayback},e.globalWarming.playback.isPlaying?r.a.createElement(w.a,{className:Object(s.a)(a.playIcon,"fal fa-pause")}):r.a.createElement(w.a,{className:Object(s.a)(a.playIcon,"fal fa-play")}))),r.a.createElement(T.a,{item:!0,xs:!0,style:{alignSelf:"center"}},r.a.createElement(D.a,{value:e.globalWarming.playback.year,min:(new Date).getFullYear(),max:2100,step:1,onChange:function(a,t){e.globalWarming.playback.isPlaying&&e.togglePlayback(),e.setPlaybackYear("number"===typeof t?t:t[0])},"aria-labelledby":"continuous-slider",valueLabelDisplay:"auto"})))))))}),de=[{path:"/",exact:!1,sidebar:function(){return null},main:function(){return r.a.createElement(ue,null)},icon:"fal fa-water",name:"Schimb\u0103ri climatice"},{path:"/avalanche/",sidebar:function(){return null},main:function(){return r.a.createElement(ue,null)},icon:"fal fa-mountain",name:"Risc de avalan\u0219\u0103"}];function ge(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function me(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?ge(t,!0).forEach(function(a){Object(c.a)(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ge(t).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}var pe=Object(g.a)({palette:{primary:{main:"#6a1b9a"},secondary:{main:"#009688"}}}),fe=Object(d.a)(function(e){return Object(m.a)({root:{flex:1},list:{width:250},fullList:{width:"auto"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:240,width:"calc(100% - ".concat(240,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:240,flexShrink:0,whiteSpace:"nowrap"},drawerPaper:{backgroundColor:e.palette.background.paper},drawerOpen:{width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:{transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1},toolbar:me({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),content:{flexGrow:1,padding:e.spacing(3)},faIcon:{width:"unset"},symbolLogo:{height:32,margin:"0 auto",display:"inherit"},logoContainer:{padding:e.spacing(1),paddiogTop:e.spacing(2),paddingBottom:e.spacing(2)}})}),be=function(e){var a,t,n=fe(),i=Object(p.a)(),l=r.a.useState(),d=Object(o.a)(l,2),g=d[0],m=d[1];i.palette.type="dark",r.a.useEffect(function(){Object(u.loadCSS)("https://pro.fontawesome.com/releases/v5.10.1/css/all.css",document.querySelector("#font-awesome-css"))},[]);return r.a.createElement(P.a,{theme:pe},r.a.createElement("div",{className:n.root},r.a.createElement(f.a,null),r.a.createElement(b.a,{variant:"permanent",className:Object(s.a)(n.drawer,(a={},Object(c.a)(a,n.drawerOpen,g),Object(c.a)(a,n.drawerClose,!g),a)),classes:{paper:Object(s.a)(n.drawerPaper,(t={},Object(c.a)(t,n.drawerOpen,g),Object(c.a)(t,n.drawerClose,!g),t))},open:g},r.a.createElement("div",{className:n.toolbar},r.a.createElement(y.a,{style:g?{}:{margin:"0 auto",flex:"unset"},onClick:g?function(){m(!1)}:function(){m(!0)}},g?r.a.createElement(S.a,null):r.a.createElement(x.a,null))),r.a.createElement(h.a,null),r.a.createElement("div",{className:n.logoContainer},g?r.a.createElement("img",{alt:"",src:"".concat("/disaster-atlas","/logos/logo_color.svg"),className:n.symbolLogo}):r.a.createElement("img",{alt:"",src:"".concat("/disaster-atlas","/logos/simbol_color.svg"),className:n.symbolLogo})),r.a.createElement(h.a,null),r.a.createElement(v.a,null,de.map(function(e,a){return r.a.createElement(E.a,{component:(t=e.path,r.a.forwardRef(function(e,a){return r.a.createElement(R.b,Object.assign({innerRef:a,to:t},e))})),button:!0,key:a},r.a.createElement(O.a,null,r.a.createElement(w.a,{className:Object(s.a)(n.faIcon,e.icon)})),r.a.createElement(j.a,{primary:e.name}));var t}))),r.a.createElement("main",{className:n.content},de.map(function(e,a){return r.a.createElement(L.a,{key:a,path:e.path,exact:e.exact,component:e.main})}))))},ye=t(99);function he(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ve(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?he(t,!0).forEach(function(a){Object(c.a)(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):he(t).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}var Ee={uats:[],counties:[],seaLevels:[],playback:{year:(new Date).getFullYear(),isPlaying:!1}};var Oe=t(214),we=t(215),je=Object(ye.c)({globalWarming:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case Q:return ve({},e,{selectedRegion:void 0});case K:return ve({},e,{selectedRegion:a.selectedRegion});case q:return ve({},e,{playback:ve({},e.playback,{isPlaying:!e.playback.isPlaying})});case Z:return ve({},e,{playback:ve({},e.playback,{year:a.year})});case X:return"UAT"===a.regions.type?ve({},e,{uats:a.regions.data}):ve({},e,{counties:a.regions.data});case H:return ve({},e,{seaLevels:a.levels});default:return e}}}),ke={actionSanitizer:function(e){return e.type,e},stateSanitizer:function(e){return e}},Se=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__(ke)||ye.d,We=Object(we.createLogger)({collapsed:!0,predicate:function(e,a){return!1}}),xe=Object(ye.e)(je,Se(Object(ye.a)(Oe.a,We)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(R.a,{basename:"/disaster-atlas"},r.a.createElement(re.a,{store:xe},r.a.createElement(be,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[245,1,2]]]);
//# sourceMappingURL=main.6b174354.chunk.js.map